customElements.define("date-counter",class extends HTMLElement{get date(){return new Date(this.getAttribute("date")||"2038-01-19 03:14:07")}get eventname(){return this.getAttribute("event")||"Y2K38 Epochalypse <a href='//en.wikipedia.org/wiki/Y2K38' style='font-size:40%'>wtf?</a>"}connectedCallback(){let e=["years","days","hours","minutes","seconds"],t=this.getAttribute("count")?.split(",")||e.filter((e=>!this.hasAttribute("no"+e))),n=e.map((e=>new Intl.RelativeTimeFormat(this.getAttribute("locale")||"en",{numeric:"auto"}).formatToParts(10,e)[2].value.trim())),i=e.reduce(((e,i,a)=>(t.includes(i)&&e.push(n[a]),e)),[]),a=({tag:e="div",id:t,append:n=[],...i})=>(this[t]=Object.assign(document.createElement(e),{id:t,...i}),this[t].append(...n),this[t].part=t,this[t]),r=(e,t,n,i=`${e}-${t}`,a=`--${this.localName}-${i}`)=>`${t}:${this.getAttribute(i)||`var(${a},${n})`};`;this.attachShadow({mode:"open"}).append(a({tag:"style",id:"date-counter-style",innerHTML:":host {display:inline-block;"+r("","font-family","arial")+r("","width","",6*t.length+"rem")+"}#event{"+r("event","padding","0 1rem")+r("event","background","gold")+r("event","color","black")+r("event","text-align","center")+r("event","font-size","2.5rem")+"}"+`#counters{display:grid;grid:1fr/repeat(${t.length},1fr);grid-auto-flow:row;`+r("counters","background","green")+r("counters","color","white")+r("counters","text-align","center")+r("counters","font-size","2.5rem")+'}[part*="label"]{'+r("label","padding","0 1rem")+r("label","font-size",".4em")+"}"}),a({id:"event",innerHTML:`<slot>${this.eventname}</slot>`}),a({id:"counters",append:t.map((e=>a({id:e+"date",append:[a({id:e,innerHTML:"0"}),a({id:e+"label",innerHTML:(i[t.indexOf(e)]||"").toUpperCase()})]})))}));let s=setInterval((()=>{let e=this.difference(this.date);t.map((t=>this["_"+t]==e[t]?0:this[t].innerHTML=this["_"+t]=e[t])),t.every((t=>0==e[t]))&&clearInterval(s)}),1e3)}difference(e,t=new Date,n=new Date(e)){let i=n<t&&([t,n]=[n,t]),a=n-t,r=864e5,s={years:~~(a/(365*r))},l=0;for(let e=t.getFullYear();e<n.getFullYear();e++)(e%4==0&&e%100!=0||e%400==0)&&(i?l--:l++);return s.days=~~((a-=s.years*r*365)/r)+l,s.hours=~~((a-=(s.days-l)*r)/36e5),s.minutes=~~((a-=1e3*s.hours*60*60)/6e4),s.seconds=~~((a-=1e3*s.minutes*60)/1e3),s}});